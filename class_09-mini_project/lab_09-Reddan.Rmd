---
title: "Mini Project"
author: 'Jack Reddan (PID: A59010543)'
date: "10/27/2021"
#output: pdf_document
output: github_document
---
>Load libraries  

```{r}
library(ggplot2)
library(factoextra)
```


# Exploratroy data analysis  
  
## Organizing the data  

First I read in the data from 'WisconsinCancer.csv" with the first column as the row names.  

```{r}
fna_data <- "WisconsinCancer.csv"
wisconsin_df <- read.csv(fna_data, row.names = 1)
```

Then I look at the data to asses the structure of the data.  

```{r}
str(wisconsin_df)
```
  
The first row contains the diagnoses which are the outputs we are trying to
derive from the data. This will be removed to generate the naive dataframe.
Additionally, these results are saved as the vector 'diagnosis'.

```{r}
# The data seems to have a extraneous ',' at the end of the column names
# Take out the artifact column 'X' from the read-in.
naive_wisconsin_df <- wisconsin_df[,c(-1, -ncol(wisconsin_df))]
diagnosis <- factor(wisconsin_df[,1])
```

## Explore the data

>[Q1]: How many observations are in the dataset?  

```{r}
nrow(wisconsin_df)
```
  
There are 569 rows/observations.  
  
>[Q2]: How many of the observations have a malignant diagnoses?  
  
```{r}
table(diagnosis)
```
  
212 of the observations have a "M" or malignant diagnoses.  
  
>[Q3]: How many variables/features in the data are suffixed with `_mean`?  
  
```{r}
length(grep("_mean", colnames(naive_wisconsin_df)))
```
  
There are 10 variables/features (columns) which are suffixed with `_mean`.  
  
# Principal Component Analysis  
  
## Performing PCA  
  
Check the means and Standard deviations of the variables.  

```{r}
colMeans(naive_wisconsin_df)
```
  
```{r}
apply(naive_wisconsin_df, 2, sd)
```

Run the 'prcomp()' on the Wisconsin dataframe with scaling to account for 
different variables having variable scales of values.  
  
```{r}
wisconsin_pca <- prcomp(naive_wisconsin_df, scale = TRUE)
```

```{r}
summary(wisconsin_pca)
```

>[Q4]: From your results, what proportion of the original variance is captured 
by the first principal component (PC1)?  
  
*See above*  
44.27%  
  
>[Q5]: How many principal components (PCs) are required to describe at least 70% 
of the original variance in the data?  
  
*See above*  
Three PCs [PC1 - PC3], explains 72.636%.  
  
>[Q6]: How many principal components (PCs) are required to describe at least 90%
of the original variance in the data?  
  
*See above*  
Seven PCs [PC1 - PC7], explains 91.010%.  
  
## Interpreting PCA Results  
  
```{r}
biplot(wisconsin_pca)
```
  
>[Q7]: What stands out to you about this plot? Is it easy or difficult to 
understand? Why?  
  
```{r}
plot(x = wisconsin_pca$x[,1], y = wisconsin_pca$x[,2], 
     col = diagnosis, 
     xlab = "PC1", ylab = "PC2")
```
  
>[Q8]: Generate a similar plot for principal components 1 and 3. What do you 
notice about these plots?
  
```{r}
plot(x = wisconsin_pca$x[,1], y = wisconsin_pca$x[,3], 
     col = diagnosis, 
     xlab = "PC1", 
     ylab = "PC3")
```
  
```{r}
wisconsin_pca_df <- as.data.frame(wisconsin_pca$x)
wisconsin_pca_df$diagnosis <- diagnosis 
```

```{r}
ggplot(data = wisconsin_pca_df) +
  aes(x = PC1, y = PC2,
      col = diagnosis) +
  geom_point()
```
  
## Variance Explained  
  
```{r}
wisconsin_pca_variance <- wisconsin_pca$sdev^2
head(wisconsin_pca_variance)
```
  
```{r}
wisconsin_pca_variance_prop <- wisconsin_pca_variance / sum(wisconsin_pca_variance)
```

```{r}
plot(wisconsin_pca_variance_prop, 
     xlab = "Principal Component",
     ylab = "Proportion of Variance Explained",
     ylim = c(0, 1),
     type = "o")
```
  
```{r}
barplot(wisconsin_pca_variance_prop,
        ylab = "Percent of Variance Explained",
        names.arg = paste0("PC", 1:length(wisconsin_pca_variance_prop)),
        las = 2,
        axes = FALSE)
axis(2, 
     at=wisconsin_pca_variance_prop,
     labels = round(wisconsin_pca_variance_prop, 2)*100)
```
  
```{r}
fviz_eig(wisconsin_pca, 
         addlabels = TRUE)
```


## Communicatin PCA Results  
  
>[Q9] For the first principal component, what is the component of the loading 
vector (i.e. `wisc.pr$rotation[,1]`) for the feature `concave.points_mean`?  
  
```{r}
wisconsin_pca$rotation[grep("concave.points_mean", row.names(wisconsin_pca$rotation)),1]
```
  
>[Q10] What is the minimum number of principal components required to explain 80%
of the variance of the data?  
  
```{r}
vals = c("sum" = 0, "count" = 1)
while(vals[1] < 0.8){
  vals[1] = vals[1] + wisconsin_pca_variance_prop[vals[2]]
  vals[2] = vals[2] + 1
}

paste0("It takes a minimum of ",  vals[2] - 1, " PCs to explain ", round(vals[1]*100, 2), "% of the data",
       sep = "")
```
  
# Hierarchical Clustering  
  
```{r}
wisconsin_data_scaled <- scale(naive_wisconsin_df)
```
